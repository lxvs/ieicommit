#!/bin/bash

OPTIND=1

while getopts "h?" opt; do
    case "$opt" in
        h|\?)
            echo -e "\nAmend last commit"
            echo -e "Usage:"
            echo -e "jgamendlastcommit [<message>]\n"
            echo -e "Amend last commit, equivalent to\ngit commit --amend --no-edit\nwhen no <message> provided, otherwise equivalent to\ngit commit --amend -m <message>\n"
            echo -e "Note: quote <message> when it contains white spaces."
            exit 0
            ;;
    esac
done

shift $((OPTIND-1))

[[ "${1:-}" = "--" ]] && shift

if [[ $# -gt 1 ]]; then
    echo "if there is whitespace in your message, please quote it."
    exit 1
elif [[ $# -eq 1 ]]; then
    git commit --amend -m "$1"
else
    git commit --amend --no-edit
fi
